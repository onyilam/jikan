{% extends 'base.html' %}
{% load socialaccount %}
{% load widget_tweaks %}
{% block javascript%}
<script>
    $(document).ready(function(){
      $(".like_button").click(function(){
            var pk = $(this).data('pid')
            $.ajax({
                type: "GET",
                data: {'pk': pk,
                       'liked': $("span").hasClass('fa fa-thumbs-up') },
                url: "{% url 'search:like_paper' %}",
                success: function(response) {
                    $("#like_count_"+ pk).html(response.likes )
                },
                error: function(response, error) {
                    alert(error);
                }
            });
        });
      });
</script>
{% endblock %}


{% block fullwidthheader %}
    <section class="features">
    <div class="col-md-7 col-md-offset-2">
        {% if paper %}

        <h4>Details for <b>{{ paper.title }}</b></h4>
        <p>Status: {{paper.get_status_display }} </p>
        <a href="#" class="like_button" data-pid="{{ paper.pk }}"> <span class="like_span fa fa-thumbs-up"></span>
            <strong id="like_count_{{ paper.pk }}">{{paper.likes}} </strong> </a>
            <p>Abstract:
                <br>{{ paper.abstract }}</p>

        {% endif %}

        {% if paper.document %}
        <embed src={{paper.document.url}} width="800" height="1000"
          type="application/pdf">

        {% else %}



        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <button type='button' class="btn btn-primary">Upload Paper</button>
          <input type="file" name="myfile">
        </form>



        {% endif %}

    </div>

    <div class="container">


      <div class="col-md-7 col-md-offset-2" id="disqus_thread"></div>
    
        <script>

        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = 'http://127.0.0.1:8000/paper/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://jikan-1.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




      <!-- {% for comment in paper.comments.all %}
          {% if user.is_authenticated or comment.approved_comment %}
          <div class="comment">
              <div class="date">
                  {{ comment.created_date }}
                  {% if not comment.approved_comment %}
                      <a class="btn btn-default" href="{% url 'comment_remove' pk=comment.pk %}"><span class="glyphicon glyphicon-remove"></span></a>
                      <a class="btn btn-default" href="{% url 'comment_approve' pk=comment.pk %}"><span class="glyphicon glyphicon-ok"></span></a>
                  {% endif %}
              </div>
              <strong>{{ comment.author }}</strong>
              <p>{{ comment.text|linebreaks }}</p>
          </div>
          {% endif %}
      {% empty %}
          <p>No comments here yet :( </p>
      {% endfor %} -->

      </div>

    </section>

{% endblock fullwidthheader %}
